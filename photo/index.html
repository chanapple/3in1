<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Document</title>
		<!-- jquery cdn -->
		<script
			src="https://code.jquery.com/jquery-3.7.1.min.js"
			integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo="
			crossorigin="anonymous"
		></script>
		<!-- fabric cdn -->
		<script src="https://cdn.jsdelivr.net/npm/fabric@6.0.2/dist/index.min.js"></script>
		<!-- spectrum cdn -->
		<script src="https://cdnjs.cloudflare.com/ajax/libs/spectrum/1.8.0/spectrum.min.js"></script>
		<!-- spectrum cdn -->
		<link
			rel="stylesheet"
			type="text/css"
			href="https://cdnjs.cloudflare.com/ajax/libs/spectrum/1.8.0/spectrum.min.css"
		/>
	</head>
	<body>
		<div>
			<!-- 브러시 크기 -->
			브러시 크기<input
				id="brush_size"
				type="number"
				min="0"
				max="100"
				value="5"
			/>

			<!-- 펜 색상 버튼 -->
			<button id="black">BLACK</button>
			<button id="red">RED</button>
			<button id="blue">BLUE</button>
			<button id="erase">ERASE</button>

			<!-- canvas 크기와 테두리 스타일 -->
			<canvas
				id="canvas"
				width="500px"
				height="500px"
				style="
					border-radius: 15px;
					box-shadow: 0 4px 6px rgba(50, 50, 93, 0.11),
						0 1px 3px rgba(0, 0, 0, 0.068);
				"
			></canvas>
		</div>

		<script>
			var brush_size = 5;
			// HTML 문서가 완전히 로드될 때까지 기다린 후 코드를 실행
			document.addEventListener("DOMContentLoaded", function () {
				//id=canvas를 이용해서 canvas 만듦
				const canvas = new fabric.Canvas("canvas", {
					isDrawingMode: true, // 그리기 모드 활성화
					backgroundColor: "white" // 캔버스 배경색을 흰색으로 설정
				});

				// freeDrawingBrush가 undefined라서 PencilBrush를 수동으로 설정함.
				canvas.freeDrawingBrush = new fabric.PencilBrush(canvas);

				// 기본 그리기 브러시 너비와 색상을 검정으로 설정
				canvas.freeDrawingBrush.width = brush_size;
				canvas.freeDrawingBrush.color = "black";

				//브러시 크기 변경.
				document
					.getElementById("brush_size")
					.addEventListener("change", event => {
						brush_size = parseInt(event.target.value, 10);
						canvas.freeDrawingBrush.width = brush_size;
						console.log(event.target.value);
					});

				// 색상 변경
				// "검정" 버튼 클릭에 대한 이벤트 리스너
				document.getElementById("black").addEventListener("click", () => {
					// 그리기 브러시 너비와 색상을 검정으로 변경
					canvas.freeDrawingBrush.width = brush_size;
					canvas.freeDrawingBrush.color = "black";
				});

				// "빨강" 버튼 클릭에 대한 이벤트 리스너
				document.getElementById("red").addEventListener("click", () => {
					// 그리기 브러시 너비와 색상을 빨강으로 변경
					canvas.freeDrawingBrush.width = brush_size;
					canvas.freeDrawingBrush.color = "red";
				});

				// "파랑" 버튼 클릭에 대한 이벤트 리스너
				document.getElementById("blue").addEventListener("click", () => {
					// 그리기 브러시 너비와 색상을 파랑으로 변경
					canvas.freeDrawingBrush.width = brush_size;
					canvas.freeDrawingBrush.color = "blue";
				});

				// "지우개" 버튼 클릭에 대한 이벤트 리스너
				document.getElementById("erase").addEventListener("click", () => {
					// 그리기 브러시 너비를 크게 설정하여 지우개 효과를 시뮬레이트하고
					// 색상을 캔버스 배경색으로 설정
					canvas.freeDrawingBrush.width = brush_size;
					canvas.freeDrawingBrush.color = canvas.backgroundColor;
				});
			});
		</script>
	</body>
</html>
